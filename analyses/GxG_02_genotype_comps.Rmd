---
title: "Genotype x genotype interactions in host manipulation - Analyses"
author: "Dan Benesh"
output: github_document
---

```{r setup, include=FALSE}
library(ggplot2)
library(dplyr)
library(tidyr)
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)
options(stringsAsFactors = FALSE)
theme_set(new = theme_bw())
```

# Experiment Background

Many parasites manipulate the behavior of their hosts in ways that seem beneficial. Little is known about genetic variation in this phenotype. Are parasites genetically variable in how much they manipulate host behavior? Do different host genotypes resist manipulation better than others? I infected 5 host strains with 5 parasite strains to quantify the variability in host manipulation due to parasite genes, host genes, and their interactions. The host-parasite system I used was the tapeworm *Schistocephalus solidus* in its copepod first intermediate host.

```{r importdata}
# import data - averaged within recordings
bd <- read.csv(file = "../data/behav_manutracked_reduced_dataset.csv", header = TRUE) # manual data
bdr <- read.csv(file = "../data/behav_autotracked_reduced_dataset.csv", header = TRUE) # auto-tracked data
infd <- read.csv(file = "../data/GxG_inf.csv", header = TRUE, fileEncoding = "UTF-8-BOM") #excel attached BOM to csv
```

```{r}
# take average worm size
infd <- mutate(infd, proc_size = (proc_size1 + proc_size2)/2)
```

```{r}
# add useful variables to manual data
bd <- mutate(bd, speed_per_sec = tot_dist/frames_tracked * 0.5,
       cop_name = substring(fname, 1, 5),
       day_char = substring(fname, 7, 8))
# combine with inf data
bd <- left_join(bd, select(infd, -proc_size1, -proc_size2, -exposed, -tank, -cerc_multinom, -remarks),
                by = 'cop_name')
```
```{r}
# add useful variables to auto data
bdr <- mutate(bdr, speed_per_sec = tot_dist/frames_tracked * 2,
       cop_name = substring(fname, 1, 5),
       day_char = substring(fname, 7, 8))
bdr <- left_join(bdr, select(infd, -proc_size1, -proc_size2, -exposed, -tank, -cerc_multinom, -remarks),
                by = 'cop_name')
```

```{r}
# compare manual and auto as quality control
bd_comp <- left_join(bdr, bd, by = c("fname", "group"))
ggplot(bd_comp, aes(x = speed_per_sec.x, y = speed_per_sec.y)) + 
  geom_point(alpha = 0.1) + 
  facet_grid(~group) +
  labs(x = 'auto speed', y = 'manual speed')
```

OUTLINE
Describe treatment differences - pool uninfecteds
GxG - absolute vs relative manipulation (abs simpler, relative is relative to controls)
Correlated parasite traits?
Quant genetics or at least variance partitioning



# Exploratory Analyses

Make graph comparing treatments.

The infected copepods are less active than the uninfected copepods. This is true both before and after the simulated attack. When we separate this plot into the different days of the experiment, we see a similar pattern. Maybe at the earliest time point, day 5, the infected copepods are less manipulated.

